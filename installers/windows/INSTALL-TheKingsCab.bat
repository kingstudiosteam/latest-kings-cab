@echo off
title The King's Cab v1.0.0 - Professional IR Loader Installation
color 0A

cls
echo.
echo     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
echo     â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•
echo        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
echo        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
echo        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
echo        â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•    â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•  â•šâ•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•
echo.
echo                           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
echo                          â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
echo                          â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
echo                          â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
echo                          â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
echo                           â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â• 
echo.
echo ===============================================================================
echo                     PROFESSIONAL IMPULSE RESPONSE LOADER
echo                              Version 1.0.0
echo                             By King Studios
echo ===============================================================================
echo.
echo Compatible with:
echo   âœ“ Pro Tools (AAX Plugin)
echo   âœ“ Reaper, Cubase, Studio One (VST3 Plugin)  
echo   âœ“ All major 64-bit DAWs
echo.
echo Installation includes:
echo   âœ“ Professional plugin binaries
echo   âœ“ Complete IR collection (500+ impulse responses)
echo   âœ“ Vintage Neve/API style interface
echo   âœ“ 6-slot cabinet simulation system
echo.
echo SYSTEM REQUIREMENTS:
echo   â€¢ Windows 10 (64-bit) or later
echo   â€¢ Administrator privileges
echo   â€¢ 50MB free disk space
echo.
echo ===============================================================================
echo.
set /p confirm="Press ENTER to begin installation or CTRL+C to cancel: "

echo.
echo Checking system requirements...
timeout /t 1 /nobreak >nul

REM Check for 64-bit Windows
if not "%PROCESSOR_ARCHITECTURE%"=="AMD64" (
    echo âŒ ERROR: This plugin requires 64-bit Windows
    pause
    exit /b 1
)
echo âœ“ 64-bit Windows detected

REM Check for administrator privileges
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo.
    echo âš ï¸  Administrator privileges required!
    echo    Please run this installer as Administrator.
    echo.
    echo    Right-click this file and select "Run as administrator"
    echo.
    pause
    exit /b 1
)
echo âœ“ Administrator privileges confirmed

echo.
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚                          INSTALLING THE KING'S CAB                         â”‚
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

echo [1/6] Creating directories...
mkdir "%ProgramFiles%\Common Files\VST3" 2>nul
mkdir "%ProgramFiles%\Common Files\Avid\Audio\Plug-Ins" 2>nul
mkdir "%ProgramData%\King Studios" 2>nul
mkdir "%ProgramData%\King Studios\The King's Cab" 2>nul
mkdir "%ProgramData%\King Studios\The King's Cab\IR Collections" 2>nul
echo      âœ“ Plugin directories created

echo [2/6] Installing VST3 plugin...
if exist "%~dp0plugins\VST3\The King's Cab.vst3" (
    xcopy /E /I /Y "%~dp0plugins\VST3\The King's Cab.vst3" "%ProgramFiles%\Common Files\VST3\The King's Cab.vst3" >nul 2>&1
    echo      âœ“ VST3 plugin installed
) else (
    echo      âš ï¸  VST3 plugin files not found
)

echo [3/6] Installing AAX plugin for Pro Tools...
if exist "%~dp0plugins\AAX\The King's Cab.aaxplugin" (
    xcopy /E /I /Y "%~dp0plugins\AAX\The King's Cab.aaxplugin" "%ProgramFiles%\Common Files\Avid\Audio\Plug-Ins\The King's Cab.aaxplugin" >nul 2>&1
    echo      âœ“ AAX plugin installed
) else (
    echo      âš ï¸  AAX plugin files not found
)

echo [4/6] Installing IR Collections...
if exist "%~dp0ir_collections" (
    xcopy /E /I /Y "%~dp0ir_collections\*" "%ProgramData%\King Studios\The King's Cab\IR Collections" >nul 2>&1
    echo      âœ“ IR Collections installed
    
    echo      ğŸ“ Collections included:
    for /d %%i in ("%~dp0ir_collections\*") do echo         â€¢ %%~nxi
) else (
    echo      âš ï¸  IR Collections not found
)

echo [5/6] Setting permissions...
icacls "%ProgramFiles%\Common Files\VST3\The King's Cab.vst3" /grant Users:F /T >nul 2>&1
icacls "%ProgramFiles%\Common Files\Avid\Audio\Plug-Ins\The King's Cab.aaxplugin" /grant Users:F /T >nul 2>&1
icacls "%ProgramData%\King Studios\The King's Cab" /grant Users:F /T >nul 2>&1
echo      âœ“ Permissions configured

echo [6/6] Creating registry entries...
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\The King's Cab" /v "DisplayName" /t REG_SZ /d "The King's Cab" /f >nul 2>&1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\The King's Cab" /v "DisplayVersion" /t REG_SZ /d "1.0.0" /f >nul 2>&1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\The King's Cab" /v "Publisher" /t REG_SZ /d "King Studios" /f >nul 2>&1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\The King's Cab" /v "URLInfoAbout" /t REG_SZ /d "https://www.kingstudiospa.com" /f >nul 2>&1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\The King's Cab" /v "NoModify" /t REG_DWORD /d 1 /f >nul 2>&1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\The King's Cab" /v "NoRepair" /t REG_DWORD /d 1 /f >nul 2>&1
echo      âœ“ Registry entries created

echo.
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚                        âœ… INSTALLATION COMPLETED!                           â”‚
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.
echo ğŸ¸ The King's Cab has been successfully installed!
echo.
echo ğŸ“ INSTALLATION LOCATIONS:
echo    â€¢ VST3: %ProgramFiles%\Common Files\VST3\
echo    â€¢ AAX:  %ProgramFiles%\Common Files\Avid\Audio\Plug-Ins\
echo    â€¢ IRs:  %ProgramData%\King Studios\The King's Cab\IR Collections\
echo.
echo ğŸš€ NEXT STEPS:
echo    1. Restart your DAW (Pro Tools, Reaper, Cubase, etc.)
echo    2. Look for "The King's Cab" in your plugin list
echo    3. Load your first IR and start creating!
echo.
echo ğŸ’° PREMIUM CONTENT:
echo    Visit https://www.kingstudiospa.com/store for additional IR collections
echo.
echo ===============================================================================
echo              Thank you for choosing King Studios professional audio!
echo ===============================================================================
echo.
pause

REM Optional: Open the store page
set /p openstore="Would you like to visit the King Studios store now? (y/n): "
if /i "%openstore%"=="y" start https://www.kingstudiospa.com/store
